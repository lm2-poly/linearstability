function answer=Ubfunc(y,H)
%{
delta=0.8;
dU=1;

%TANH MIXING LAYER
answer(1,1)=1+dU*tanh(2*(y-1)/delta);
answer(1,2)=2*dU*(1-tanh(2*(y-1)/delta)^2)/delta;
answer(1,3)=-8*dU*tanh(2*(y-1)/delta)*(1-tanh(2*(y-1)/delta)^2)/delta^2;

return
%}

%MEAN DIMENSIONLESS VELOCITY PROFILE FROM THE LES
%HEIGH
dataydim=[0.0400200001900000,0.1199909970000000,0.2000309974000000,0.2800019979000000,0.3599730134000000,0.4400130212000000,0.5199840069000000,0.6000239849000000,0.6799950004000000,0.7599660158000000,0.8400059938000000,0.9199770093000000,1.0000170470000000,1.0799880030000000,1.1600279810000000,1.2399989370000000,1.3199700120000000,1.4000099900000000,1.4799810650000000,1.5600210430000000,1.6399919990000000,1.7200319770000000,1.8000030520000000,1.8799740080000000,1.9600139860000000,2.0399849410000000,2.1200249200000000,2.1999959950000000,2.2799670700000000,2.3600070480000000,2.4399781230000000,2.5200181010000000,2.5999889370000000,2.6800289150000000,2.7599999900000000,2.8399710660000000,2.9200110440000000,2.9999818800000000,3.0800218580000000,3.1599929330000000,3.2400331500000000,3.3200042250000000,3.3999748230000000,3.4993348120000000,3.6333329680000000,3.7943100930000000,3.9756419660000000,4.1716022490000000,4.3772912030000000,4.5890522000000000,4.8039178850000000,5.0200948720000000];
%VELOCITY
dataUdim=[0.1694000065000000,0.3454999924000000,0.5307999849000000,0.7944999933000000,1.1009999510000000,1.5766999720000000,2.1447999480000000,3.0234000680000000,3.8482999800000000,5.3968000410000000,5.7273998260000000,6.4566001890000000,6.7733001710000000,7.2635002140000000,7.5672001840000000,7.9559998510000000,8.2477998730000000,8.5767002110000000,8.8461999890000000,9.1346998210000000,9.3816003800000000,9.6339998250000000,9.8600997920000000,10.0865001700000000,10.2896003700000000,10.4935998900000000,10.6786003100000000,10.8626003300000000,11.0355997100000000,11.2079000500000000,11.3648004500000000,11.5211000400000000,11.6658000900000000,11.8112001400000000,11.9461002300000000,12.0836000400000000,12.2075996400000000,12.3381996200000000,12.4505996700000000,12.5729999500000000,12.6740999200000000,12.7896003700000000,12.8853998200000000,13.0027999900000000,13.1787996300000000,13.3657999000000000,13.5816001900000000,13.7955999400000000,14.0176000600000000,14.2423000300000000,14.4774999600000000,14.7293996800000000];


h=0.69;
datay=dataydim/h;
dataU=dataUdim/interp1(dataydim,dataUdim,h);

hdata=max(datay);

if y<hdata
    imethod='pchip';
else
    imethod='linear';
end

answer(1,1)=interp1(datay,dataU,y,imethod,'extrap');
delta=(0.1199909970000000-0.0400200001900000)/h;
uc=answer(1,1);
up=interp1(datay,dataU,y+delta,imethod,'extrap');
if y<delta
    um=0;
else
    um=interp1(datay,dataU,y-delta,imethod,'extrap');
end
answer(1,2)=(up-um)/2/delta;
answer(1,3)=(up-2*uc+um)/delta^2;
return

%THE MODEL CAN ALSO BE USED WITH A TANH PROFILE. SIMPLY QUOTE THE PREVIOUS
%PROFILE AND UNQUOTE ONE OF THE FOLLOWING


%{
delta=0.8;
dU=1;

%TANH MIXING LAYER
answer(1,1)=1+dU*tanh(2*(y-1)/delta);
answer(1,2)=2*dU*(1-tanh(2*(y-1)/delta)^2)/delta;
answer(1,3)=-8*dU*tanh(2*(y-1)/delta)*(1-tanh(2*(y-1)/delta)^2)/delta^2;

return
%}


%}
%TANH MIXING LAYER IN THE MIDDLE OF THE DOMAIN
%answer(1,1)=tanh((y-H/2));
%answer(1,2)=1-tanh(-y+1/2*H)^2;
%answer(1,3)=-2*tanh(-y+1/2*H)*(-1+tanh(-y+1/2*H)^2);

%return
%}
